<div class=" main-body min-h-screen bg-gray-50 dark:bg-gray-900 flex flex-col justify-between">
  <!-- Header -->
  <header class="relative w-full bg-green-100 bg-vertical-lines text-center py-8 shadow-md">
    <button
      class="absolute top-4 left-4 w-8 h-8 flex items-center justify-center bg-white text-gray-800 rounded-full shadow-sm hover:bg-gray-100 dark:bg-gray-800 dark:text-white transition-all"
      (click)="goBack()" title="Voltar">
      <i class="fa fa-arrow-left"></i>
    </button>
    <h1
      class=" mt-4 flex flex-col items-center text-3xl font-bold tracking-wide text-off-white text-shadow-rosy font-poppins">
      {{ category | titlecase }} Recipes
    </h1>

  </header>

  <!-- Lista de Receitas -->
  <main class="flex-grow flex justify-center items-start p-6">
    <div *ngIf="recipes.length; else noRecipes" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      <div *ngFor="let recipe of recipes" class="relative retro-card bg-pastel-blue">
        <span class="decorative-top-left"></span>
        <span class="decorative-top-right"></span>

        <!-- Botão de Favoritar -->
        <button class="favorite-btn" (click)="toggleFavorite(recipe)"
          [title]="recipe.isFavorite ? 'Unfavorite' : 'Favorite'">
          <i [class.fa-solid]="recipe.isFavorite" [class.fa-regular]="!recipe.isFavorite" class="fa-heart"></i>
        </button>

        <!-- Bloco de Imagem -->
        <div class="image-container">
          <img [src]="recipe.image || 'assets/default-recipe.jpg'" alt="{{ recipe.name }}"
            class="object-cover rounded-t-lg" />
        </div>

        <!-- Botão de Detalhes -->
        <div class="detail-button-container">
          <button class="retro-detail-btn" (click)="viewDetails(recipe.id)" title="Ver Detalhes">
            Ver Detalhes
          </button>
        </div>

        <div class="p-4 space-y-2">
          <!-- Nome da Receita -->
          <h2 class="text-xl font-bold text-retro-dark text-center">{{ recipe.name }}</h2>
          <!-- Tempo e Porções -->
          <p class="text-sm text-gray-600 dark:text-gray-400 text-center">
            <i class="fa fa-clock"></i> {{ recipe.time }} min |
            <i class="fa fa-users"></i> {{ recipe.servings }} porções
          </p>
          <!-- Média de Avaliação -->
          <div class="rating-container flex items-center space-x-1">
            <span class="text-retro-dark font-semibold">Média: {{ averageRating.toFixed(1) }}</span>
            <div class="stars flex">
              <ng-container *ngFor="let star of stars">
                <i *ngIf="star === 'full'" class="fa-solid fa-star text-yellow-500 text-lg"></i>
                <i *ngIf="star === 'half'" class="fa-solid fa-star-half-alt text-yellow-500 text-lg"></i>
                <i *ngIf="star === 'empty'" class="fa-regular fa-star text-gray-300 text-lg"></i>
              </ng-container>
            </div>
          </div>

          <!-- Nome do Usuário -->
          <p class="text-xs text-gray-500 dark:text-gray-400 text-center">
            Adicionado por: <span class="text-retro-dark font-semibold">{{ recipe.addedBy || 'Usuário Anônimo' }}</span>
          </p>
          <!-- Botões de Editar e Excluir -->
          <div class="flex justify-center gap-4 mt-4" *ngIf="recipe.showButtons">
            <button class="retro-btn-sm" (click)="editRecipe(recipe.id)">
              <i class="fa fa-edit"></i> Editar
            </button>
            <button class="retro-delete-btn-sm" (click)="confirmDelete(recipe.id)">
              <i class="fa fa-trash"></i> Excluir
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Mensagem de lista vazia -->
    <ng-template #noRecipes>
      <p class="text-center text-gray-500 dark:text-gray-400">Nenhuma receita encontrada nesta categoria.</p>
    </ng-template>
  </main>

</div>

<div *ngIf="showModal" class="backdrop"></div>
<div *ngIf="showModal" class="retro-modal-success">
  <div class="retro-card">
    <span class="decorative-top-left"></span>
    <span class="decorative-top-right"></span>
    <div class="content">
      <i class="fa fa-exclamation-circle icon-warning "></i>
      <h2 class="modal-title">Realmente deseja excluir?</h2>
      <div class="button-group">
        <button class="retro-cancel-btn-sm" (click)="closeModal()">Cancelar</button>
        <button class="retro-delete-btn-sm" (click)="deleteRecipe()">Excluir
        </button>
      </div>
    </div>
  </div>
</div>